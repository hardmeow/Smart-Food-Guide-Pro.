# 🍎 智食鉴 (SmartFood Scanner)

一个纯前端的食品健康分析 Web 应用，通过 AI 和 OCR 技术帮助用户快速评估食品的健康程度。

## ✨ 核心功能

### 1. **OCR 文字识别**
- 使用 Tesseract.js 识别食品包装上的文字
- 支持中文、英文等多种语言
- 自动分割配料表和营养成分表

### 2. **配料风险分析**
- 内置 30+ 种常见食品添加剂的风险数据库
- 风险等级从 0（安全）到 5（高风险）
- 支持 DeepSeek API 分析未知配料

### 3. **营养成分评估**
- 自动提取能量、蛋白质、脂肪、碳水化合物、钠、糖等成分
- 对标中国居民膳食营养素参考摄入量 (DRIs)
- 生成营养警告和建议

### 4. **健康评分**
- 综合配料风险和营养成分计算 0-100 的健康评分
- 大号仪表盘直观展示
- 自动生成健康建议

## 🚀 快速开始

### 方式 1：直接在浏览器打开（推荐）
```bash
# 双击打开 smartfood-scanner.html
# 或在浏览器中打开文件
```

### 方式 2：使用本地服务器
```bash
# 进入项目目录
cd /home/ubuntu/smartfood-scanner

# 启动 Python 服务器
python3 test-server.py

# 然后在浏览器打开
# http://localhost:8000/smartfood-scanner.html
```

### 方式 3：使用任何 HTTP 服务器
```bash
# 使用 Node.js http-server
npx http-server

# 或使用 Ruby
ruby -run -ehttpd . -p8000

# 或使用 PHP
php -S localhost:8000
```

## 🔧 配置 DeepSeek API（可选）

为了获得更好的未知配料分析效果，可以配置 DeepSeek API：

1. 在应用中点击设置或刷新页面
2. 输入您的 DeepSeek API Key（格式：`sk-xxxxxxxx`）
3. 点击保存

API Key 会被保存在浏览器本地存储中，不会上传到任何服务器。

### 获取 API Key
- 访问 [DeepSeek 官网](https://www.deepseek.com/)
- 注册账户并创建 API Key
- 示例 Key：`sk-8142641656ee480f8c1887a7c1267808`

## 📱 使用流程

```
1. 打开应用
   ↓
2. 点击"上传"或"打开相机"
   ↓
3. 拍照或选择食品包装图片
   ↓
4. 点击"开始分析"
   ↓
5. 等待 OCR 识别和 AI 分析
   ↓
6. 查看健康评分和详细建议
   ↓
7. 点击卡片展开更多信息
   ↓
8. 点击"重新扫描"分析其他食品
```

## 📊 健康评分说明

| 评分范围 | 等级 | 说明 |
|---------|------|------|
| 80-100 | 优秀 | 这是一个健康的食品选择 |
| 60-79 | 良好 | 可以适量食用 |
| 40-59 | 一般 | 建议适量减少摄入 |
| 20-39 | 较差 | 不建议频繁食用 |
| 0-19 | 很差 | 建议避免食用 |

## 🗂️ 配料风险等级

| 风险等级 | 图标 | 说明 |
|---------|------|------|
| 0 | ✓ | 安全 - 对人体有益 |
| 1 | ✓ | 较安全 - 一般认为安全 |
| 2 | ⚠ | 一般 - 过量可能不适 |
| 3 | ⚠ | 有风险 - 可能导致过敏反应 |
| 4 | ✕ | 较高风险 - 需要控制摄入量 |
| 5 | ✕ | 高风险 - 有潜在致癌风险 |

## 🧠 本地数据库

应用内置了以下类别的食品添加剂数据：

- **防腐剂**：苯甲酸钠、山梨酸钾、亚硝酸钠等
- **甜味剂**：糖精钠、阿斯巴甜、三氯蔗糖、木糖醇等
- **着色剂**：柳橙黄、胭脂红、焦糖色等
- **乳化剂**：单甘酯、卵磷脂等
- **营养强化剂**：维生素 C/E、钙、铁、锌等
- **增稠剂**：黄原胶、瓜尔豆胶等
- **其他成分**：盐、糖、油、面粉等

## 🔐 隐私和安全

- ✅ **完全离线运行**：所有处理都在本地浏览器中进行
- ✅ **无数据上传**：图片和分析结果不会上传到任何服务器
- ✅ **本地存储**：API Key 仅保存在浏览器本地存储中
- ✅ **开源透明**：代码完全开放，可审计

## 🛠️ 技术栈

| 技术 | 用途 |
|------|------|
| HTML5 | 页面结构 |
| CSS3 | 样式和响应式设计 |
| JavaScript (ES6+) | 应用逻辑 |
| Tesseract.js | OCR 文字识别 |
| DeepSeek API | AI 配料分析（可选） |
| IndexedDB/LocalStorage | 本地数据存储 |

## 📋 系统要求

- 现代浏览器（Chrome、Firefox、Safari、Edge）
- 网络连接（用于加载 Tesseract.js 库和 DeepSeek API）
- 相机或文件系统访问权限（用于上传图片）

## 🐛 常见问题

### Q: 为什么 OCR 识别不准确？
A: 请确保：
1. 图片清晰，光线充足
2. 配料表和营养成分表完整可见
3. 文字水平放置（不要倾斜或旋转）
4. 图片分辨率不要过低

### Q: 能否在离线状态下使用？
A: 可以，但需要：
1. 第一次使用时在线加载 Tesseract.js 库
2. 之后可以离线使用本地数据库分析
3. 如果使用 DeepSeek API，则需要网络连接

### Q: 如何清除保存的 API Key？
A: 在浏览器开发者工具中：
1. 打开 F12 开发者工具
2. 进入 Application → Local Storage
3. 找到 `deepseek_api_key` 并删除

### Q: 支持哪些图片格式？
A: 支持所有常见格式：JPG、PNG、GIF、WebP 等

## 📞 反馈和建议

如有问题或建议，欢迎提出！

## 📄 许可证

MIT License - 自由使用和修改

---

**🌟 提示**：首次使用时，应用会自动下载 Tesseract.js 库（约 50MB），请耐心等待。之后会被浏览器缓存，后续使用会更快。

**💡 建议**：为了获得最佳体验，建议在 WiFi 环境下首次使用，并在手机竖屏模式下操作。
